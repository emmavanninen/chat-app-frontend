(this["webpackJsonpfront-chat-app-react"]=this["webpackJsonpfront-chat-app-react"]||[]).push([[0],{126:function(e,t){},130:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(55),c=a.n(s),o=(a(71),a(2)),l=a(3),i=a(5),u=a(4),m=a(6),p=a(1),h=a.n(p),d=a(7),v=a(12),f=a(56),g=a.n(f).a.create({baseURL:"",headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*"}});console.log("production");var b=g,E=a(57),y=a.n(E),w=function(e){e?b.defaults.headers.common.Authorization="Bearer "+e:delete b.defaults.headers.common.Authorization},k=function(){var e=localStorage.getItem("token");if(!e)return null;var t=y()(e),a=Date.now()/1e3;return t.exp<a?(localStorage.removeItem("token"),w(null),null):(w(e),t)},C=function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.post("/api/users/signup",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.post("/api/users/signin",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.get("/api/users/get-user");case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.put("/api/users/edit-user",t);case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.get("/api/channels/getMessages/".concat(t));case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.get("/api/channels/getUsers/".concat(t));case 3:return a=e.sent,e.abrupt("return",a);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),P=Object(n.createContext)({}),M=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",email:"",password:"",confirmPassword:""},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(){var e=Object(d.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a.state.password===a.state.confirmPassword){e.next=4;break}return console.log("password and confirm password don't match"),e.abrupt("return");case 4:return e.prev=4,e.next=7,C(a.state);case 7:200===(n=e.sent).status&&(w(n.data.token),localStorage.setItem("token",n.data.token),a.context.setAuth(k())),400===n.status&&(r=n.data.errors)&&(r.username&&"unique"===r.username.kind&&console.log("username taken"),r.email&&"unique"===r.email.kind&&console.log("email taken")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"navTabContent"},r.a.createElement("form",{className:"navTabForm register",onSubmit:this.handleSubmit},r.a.createElement("h5",null,"Register"),r.a.createElement("label",null,r.a.createElement("h6",null,"Username"),r.a.createElement("input",{type:"text",name:"username",placeholder:"Username",onChange:this.handleChange,value:this.state.username})),r.a.createElement("label",null,r.a.createElement("h6",null,"Email"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",onChange:this.handleChange,value:this.state.email})),r.a.createElement("label",null,r.a.createElement("h6",null,"Password"),r.a.createElement("input",{type:"password",name:"password",autoComplete:"password",placeholder:"Password",onChange:this.handleChange,value:this.state.password})),r.a.createElement("label",null,r.a.createElement("h6",null,"Confirm password"),r.a.createElement("input",{type:"password",name:"confirmPassword",autoComplete:"confirm-password",onChange:this.handleChange,placeholder:"Confirm password",value:this.state.confirmPassword})),r.a.createElement("br",null),r.a.createElement("input",{className:"navButton",type:"submit",value:"Register"})))}}]),t}(n.Component);M.contextType=P;var S=M,A=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",email:"",password:""},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(){var e=Object(d.a)(h.a.mark((function e(t){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O(a.state);case 4:200===(n=e.sent).status&&(w(n.data.token),localStorage.setItem("token",n.data.token),a.context.setAuth(k())),400===n.status&&(r=n.data,a.context.handleToast(null,r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("e",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"navTabContent"},r.a.createElement("form",{className:"navTabForm login",onSubmit:this.handleSubmit},r.a.createElement("h5",null,"Login"),r.a.createElement("label",null,r.a.createElement("h6",null,"Username"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:this.handleChange,placeholder:"Username"})),r.a.createElement("label",null,r.a.createElement("h6",null,"Password"),r.a.createElement("input",{type:"password",autoComplete:"password",name:"password",value:this.state.password,onChange:this.handleChange,placeholder:"Password"})),r.a.createElement("br",null),r.a.createElement("input",{className:"navButton",type:"submit",value:"Login"})))}}]),t}(n.Component);A.contextType=P;var L=A,I=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user:{}},a.getUserInfo=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j();case 3:t=e.sent,a.setState({user:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getUserInfo()}},{key:"render",value:function(){var e=this.state.user;return r.a.createElement("div",null,r.a.createElement("h5",null,"Hello ",e.username),r.a.createElement("div",{className:"profilePic"},r.a.createElement("img",{src:""===e.photo?"/animal-15-512.png":e.photo,alt:"profile avatar"})),r.a.createElement("div",{className:"navButton logoutBtn",onClick:this.context.logout},"Logout"))}}]),t}(n.Component);I.contextType=P;var U=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,username:"",email:"",oldPassword:"",password:"",confirmNewPassword:"",photo:""},a.getUserInfo=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j();case 3:t=e.sent,a.setState({user:t,username:t.username,email:t.email}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(){var e=Object(d.a)(h.a.mark((function e(t){var n,r,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a.state.password===a.state.confirmNewPassword){e.next=4;break}return a.context.handleToast(null,"Password and confirm password don't match"),e.abrupt("return");case 4:if(!a.state.oldPassword||a.state.oldPassword!==a.state.password){e.next=7;break}return a.context.handleToast(null,"Old password and new password cannot be the same"),e.abrupt("return");case 7:for(r in n={},a.state)(s=a.state[r])&&"user"!==r&&"confirmNewPassword"!==r&&s!==a.state.user[r]&&(n[r]=s);return e.prev=9,e.next=12,x(n);case 12:200===(c=e.sent).status&&a.context.handleToast("Profile edit successful",null),400===c.status&&a.context.handleToast(null,"Poops, you did something wrong \ud83d\udca9\ud83d\udca9\ud83d\udca9"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(9),a.context.handleToast(null,"Poops, you did something wrong \ud83d\udca9\ud83d\udca9\ud83d\udca9"),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[9,17]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getUserInfo()}},{key:"render",value:function(){return r.a.createElement("div",{className:"navTabContent"},r.a.createElement("form",{className:"navTabForm edit",onSubmit:this.handleSubmit},r.a.createElement("h5",null,"Edit Profile"),r.a.createElement("label",null,r.a.createElement("h6",null,"Username"),r.a.createElement("input",{type:"text",name:"username",placeholder:"Username",onChange:this.handleChange,value:this.state.username})),r.a.createElement("label",null,r.a.createElement("h6",null,"Email"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",onChange:this.handleChange,value:this.state.email})),r.a.createElement("label",null,r.a.createElement("br",null),r.a.createElement("label",null,r.a.createElement("h6",null,"Change avatar"),r.a.createElement("input",{type:"text",name:"photo",onChange:this.handleChange,placeholder:"Avatar URL",value:this.state.photo})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h5",null,"Change password"),r.a.createElement("h6",null,"Old Password"),r.a.createElement("input",{type:"password",name:"oldPassword",autoComplete:"password",placeholder:"Old password",onChange:this.handleChange,value:this.state.oldPassword})),r.a.createElement("label",null,r.a.createElement("h6",null,"New Password"),r.a.createElement("input",{type:"password",name:"password",autoComplete:"password",placeholder:"New password",onChange:this.handleChange,value:this.state.newPassword})),r.a.createElement("label",null,r.a.createElement("h6",null,"Confirm new password"),r.a.createElement("input",{type:"password",name:"confirmNewPassword",autoComplete:"confirm-password",onChange:this.handleChange,placeholder:"Confirm new password",value:this.state.confirmPassword})),r.a.createElement("br",null),r.a.createElement("input",{className:"navButton",type:"submit",value:"Submit"})))}}]),t}(n.Component);U.contextType=P;var D=a(58),B=a.n(D),F=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={maxIsVisible:0},a.delay=function(){return a.props.delay||50},a.timeOut=function(){setTimeout((function(){a.setState({maxIsVisible:0})}),2e3)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=r.a.Children.count(this.props.children),a=0;this.interval=setInterval((function(){++a>t&&clearInterval(e.interval),e.setState({maxIsVisible:a})}),this.delay())}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.className},r.a.Children.map(this.props.children,(function(t,a){return r.a.createElement("div",{className:e.props.childClassName,style:{transition:"opacity 400ms, left 400ms",top:e.state.maxIsVisible>a?0:20,opacity:e.state.maxIsVisible>a?1:0}},t,e.timeOut())})))}}]),t}(n.Component),G=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={activeTab:""},a.handleTabClick=function(e){e!==a.state.activeTab&&a.setState({activeTab:e===a.state.activeTab?"":e})},a.renderTabsChildrenAsProps=function(){return r.a.Children.map(a.props.children,(function(e,t){return a.state.activeTab===t?r.a.cloneElement(e,{onClick:a.handleTabClick,tab:t,bgColor:"#262626"}):r.a.cloneElement(e,{onClick:a.handleTabClick,tab:t,bgColor:"#161515"})}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.context.isAuth||this.handleTabClick(0)}},{key:"render",value:function(){var e=this,t=this.props.children,a=this.state.activeTab;return r.a.createElement("div",null,r.a.createElement("div",{className:"tabs"},r.a.createElement("div",{className:"tabsNav"},this.renderTabsChildrenAsProps()),t[a]?r.a.createElement("div",{className:"activeTabContent"},this.context.toastMsg.success?r.a.createElement(F,null,r.a.createElement("div",{className:"notificationTag successNotification"},this.context.toastMsg.success)):"",this.context.toastMsg.error?r.a.createElement(F,null,r.a.createElement("div",{className:"notificationTag errorNotification"},this.context.toastMsg.error)):"",t[a].props.children,"login-tab"===t[a].props.className?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"guestBlock"},r.a.createElement("p",{className:"guestText"},"You are currently chatting as ",r.a.createElement("br",null),r.a.createElement("span",null,B.a.generateUsername("-")),r.a.createElement("br",null),"(Guest User)"),r.a.createElement("br",null),r.a.createElement("p",{className:"guestText"},"Would you like to"," ",r.a.createElement("a",{className:"tabLink register-tab registerGuestLink",onClick:function(t){t.preventDefault(),e.handleTabClick(1)}},"register")," ","?"))):""):""))}}]),t}(n.Component);G.contextType=P;var _=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"tab",style:{backgroundColor:this.props.bgColor}},r.a.createElement("a",{href:"#",className:"tabLink ".concat(this.props.className,"\n        ").concat(this.props.isActive,"\n        "),onClick:function(t){t.preventDefault(),e.props.onClick(e.props.tab)}},"".concat(this.props.label))))}}]),t}(n.Component),R=a(18),V=(a(93),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={notification:null,channels:["General","Dogs"]},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.context.toastMsg.success&&this.setState({notification:this.context.toastMsg.success}),this.context.toastMsg.error&&this.setState({notification:this.context.toastMsg.error})}},{key:"render",value:function(){return r.a.createElement("div",{className:"navMain"},r.a.createElement("div",{className:"appTitle"},"Chat App"),r.a.createElement("div",{className:"channels"},this.state.channels.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(R.b,{className:"chnl",to:"/channel/".concat(e)},e))}))),this.context.isAuth?r.a.createElement(G,null,r.a.createElement(_,{className:"profile-tab",label:"Profile"},r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("div",{className:"tabContent"},r.a.createElement(I,{user:this.state.user})))),r.a.createElement(_,{className:"edit-profile-tab",label:"Edit"},r.a.createElement("div",null,r.a.createElement("div",{className:"tabContent"},r.a.createElement(U,{user:this.state.user}))))):r.a.createElement(G,null,r.a.createElement(_,{className:"login-tab",label:"Login"},r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("div",{className:"tabContent"},r.a.createElement(L,null)))),r.a.createElement(_,{className:"register-tab",label:"Register"},r.a.createElement("div",null,r.a.createElement("div",{className:"tabContent"},r.a.createElement(S,null))))))}}]),t}(n.Component));V.contextType=P;var K=a(61),q=a(64),W=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={body:""},a.handleSubmit=function(){var e=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a.state.body.trim()?(a.props.createMessage(a.state),a.setState({body:""})):console.log("messages cannot be empty");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleKeyPress=function(e){"Enter"!==e.key||e.shiftKey||a.handleSubmit(e)},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value)),a.props.onTyping()},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"sendMsg"},r.a.createElement("form",{className:"msgForm",onKeyPress:this.handleKeyPress},r.a.createElement("textarea",{className:"writeMsgInput",name:"body",value:this.state.body,onChange:this.handleChange,placeholder:"Write a message..."}),r.a.createElement("input",{className:"sendMsgButton",type:"submit",value:"",onClick:this.handleSubmit})))}}]),t}(n.Component);W.contextType=P;var z=W,J=a(65),H=function(e){var t=Object(n.useContext)(P),a=Object(n.useState)(null),s=Object(J.a)(a,2),c=s[0],o=s[1];Object(n.useEffect)((function(){t.logoutPayload&&o(!0),t.loginPayload&&o(!1)}));var l=!c&&t.user&&t.user._id===e.message.author._id?"myMsg":"";return r.a.createElement("div",{className:"msg ".concat(l)},r.a.createElement("div",{className:"usernameInMsg"},e.message.author.username),r.a.createElement("div",{className:"msgTxt"},e.message.body),r.a.createElement("div",{className:"msgSent"},e.message.created))};function Y(e){var t;return e.messages&&(t=e.messages.map((function(e,t){return r.a.createElement(H,{key:t,message:e})}))),r.a.createElement("div",{className:"messageList"},r.a.createElement("div",{id:"userTyping"},e.onTypingMessage),r.a.createElement("div",{className:"messageList2"},t))}var Q=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"chatBoard"},r.a.createElement("div",{className:"channelTitle"},r.a.createElement("p",{className:"title"},"@",e.roomTitle?e.roomTitle:"General")),r.a.createElement("div",{className:"channelMessages"},r.a.createElement(Y,{messages:this.props.messages,onTypingMessage:this.props.onTypingMessage})),r.a.createElement(z,{createMessage:this.props.createMessage,onTyping:this.props.onTyping})))}}]),t}(n.Component);Q.contextType=P;var X=function(e){return r.a.createElement("div",{className:"userCurrentlyInChat"},e.username)};var Z=function(e){var t="-- no users --";return e.users.length&&(t=e.users.map((function(e,t){return r.a.createElement(X,Object.assign({},e,{key:t}))}))),r.a.createElement("div",{className:"onlineUsersList"},t)},$=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"inChat"},r.a.createElement("div",{className:"onlineTitle"},"In chat"),r.a.createElement(Z,{users:this.props.users}))}}]),t}(n.Component),ee=a(62),te=a.n(ee),ae=a(63),ne=a.n(ae),re=(a(130),"https://chatty-appy-api.herokuapp.com/"),se=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={messages:[],users:[],room:a.props.match.params.name||"General",channel:null,onTypingMessage:""},a.componentDidUpdate=function(e){a.props.match.params.name!==e.match.params.name&&(a.socket.disconnect(),a.setState({room:a.props.match.params.name},(function(){a.createSocket()})))},a.onChange=function(){a.socket.emit("onTyping",a.context.user)},a.createSocket=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T(a.state.room);case 3:(t=e.sent).data&&a.setState({users:t.data.liveMembers,messages:t.data.messages.slice(-10),roomId:t.data._id,channel:t.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:a.socket=te()(re,{query:"roomName=".concat(a.state.room)}),a.state.channel||a.socket.emit("createNewChannel"),localStorage.getItem("token")&&a.addLiveMember(),a.socket.on("chatroomUsers",(function(e,t,n){a.setState({users:e},(function(){n&&(a.socket.disconnect(),a.socket.off(),a.createSocket())}))})),a.socket.on("someoneTyping",(function(e){a.setState({onTypingMessage:"".concat(e," is typing..")},(function(){setTimeout((function(){a.setState({onTypingMessage:""})}),1500)}))})),a.socket.on("chat",(function(e){a.setState({messages:[].concat(Object(q.a)(a.state.messages),[e])})}));case 16:case"end":return e.stop()}}),e,null,[[0,7]])}))),a.getMessages=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N();case 3:200===(t=e.sent).status&&a.setState({messages:t.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),a.addLiveMember=function(){a.context.user&&!a.state.users.find((function(e){return e._id===a.context.user._id}))&&a.socket.emit("sendUserToServer",a.context.user,a.state.room)},a.removeLiveMember=function(){a.socket.emit("removeUserFromActiveChat",a.context.user,a.state.room),a.props.history.push("/channel/General")},a.createMessage=function(e){var t=k();if(t){var n=Object(K.a)({},e,{author:t._id,created:ne()().format("LT"),channel:a.state.roomId});a.socket.emit("createMessage",n)}},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.createSocket()}},{key:"render",value:function(){return this.context.loginPayload&&(this.addLiveMember(),this.context.resetLoginPayload()),this.context.logoutPayload&&(this.removeLiveMember(),this.context.resetLogoutPayload()),r.a.createElement("div",{className:"chatMain"},r.a.createElement(Q,{createMessage:this.createMessage,onTyping:this.onChange,onTypingMessage:this.state.onTypingMessage,messages:this.state.messages,roomTitle:this.props.match.params.name}),r.a.createElement($,{users:this.state.users}))}}]),t}(n.Component);se.contextType=P;var ce=se,oe=a(15),le=(a(131),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isAuth:!1,user:k(),toastMsg:{success:null,error:null},loginPayload:null,logoutPayload:null},a.resetLoginPayload=function(){a.setState({loginPayload:null})},a.resetLogoutPayload=function(){a.setState({logoutPayload:null})},a.setAuth=function(e){a.setState({isAuth:!0,user:e,loginPayload:e})},a.removeAuth=function(){a.setState({isAuth:!1}),localStorage.removeItem("token")},a.logout=function(){w(null),a.setState({logoutPayload:a.state.user}),a.removeAuth()},a.handleToast=function(e,t){a.setState({toastMsg:{success:e,error:t}})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.state.user&&this.setState({isAuth:!0})}},{key:"render",value:function(){var e={isAuth:this.state.isAuth,user:this.state.user,setAuth:this.setAuth,removeAuth:this.removeAuth,logout:this.logout,handleToast:this.handleToast,toastMsg:this.state.toastMsg,createMessage:this.createMessage,loginPayload:this.state.loginPayload,logoutPayload:this.state.logoutPayload,resetLoginPayload:this.resetLoginPayload,resetLogoutPayload:this.resetLogoutPayload};return r.a.createElement(r.a.Fragment,null,r.a.createElement(P.Provider,{value:e},r.a.createElement("div",{className:"App"},r.a.createElement(V,null),r.a.createElement(oe.c,null,r.a.createElement(oe.a,{path:"/channel/:name",component:ce}),r.a.createElement(oe.a,{component:ce})))))}}]),t}(n.Component));le.contextType=P;var ie=le;c.a.render(r.a.createElement(R.a,null,r.a.createElement(ie,null)),document.getElementById("root"))},66:function(e,t,a){e.exports=a(132)},71:function(e,t,a){},93:function(e,t,a){}},[[66,1,2]]]);
//# sourceMappingURL=main.005a1ed0.chunk.js.map